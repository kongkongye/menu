---
layout: post
title:  自动建筑
categories: 我的世界
tags:  自动建筑
author: kongkongye
---

* content
{:toc}

自动建筑




## 特点
1. 自动: 根据预先定义的规则,自动建造
2. 随机: 随机选择素材
3. 可控: 指定素材或类似于过滤器,减小随机选择素材的范围

## 概念
* 模型: 指一个具体的建筑模型,里面有相关信息,可以定义是否同级,模型有(矩形)范围.
* 类型: 指模型的类型,呈树状结构
* 插孔: 定义允许哪些插头插上来,插孔有矩形范围,有朝向,并且允许设置不同类型的插头与对应的几率.
* 插头: 定义后,可以插到对应的插孔上,插头有矩形范围

注意:

1. 模型没有所属类型属性: 事实上模型内有若干插头,每个插头有所属类型,而模型没有所属类型.

    这样一个模型就可以放到多个不同的类型下.

## 匹配
匹配即插孔寻找插头的过程(插头不会主动寻找插孔),分为以下几步:

1. 类型匹配: 指找到插孔允许的那些类型下的所有建筑模型
2. 大小匹配: 指过滤掉所有大小不匹配的建筑模型(指插孔的范围没法完全包含插头的范围)
3. 随机选取

## 级别
默认情况下,插孔上的插头会降低一个级别,比如房子模型上有个树的插孔,则树插上来后级别会比房子低一级.

但模型可以设置同级,这样适合一些情况,比如城墙,每个城墙都是同级的,会在同一个层次被建造完.

### 同级
这是个特殊的属性,同级主要用来重复,比如城墙,栅栏,道路等.

同级必须被包围在一个矩形范围内,在伸展的过程中,如果因触碰到边缘而停止,则最后一个模型与边缘之间的空隙会用附属来填充.

### 附属
如果模型的同级属性为true,则可以设置一个附属,附属用来填充空隙.
(因为同级的模型就是用来重复的,而重复到最后一个可能会有空隙,附属就是用来填充空隙的)

附属分为周围附属与上下附属,周围附属的长度必须为1,上下附属的高度必须为1.

## 分层建造
本项目采用`广度优先`建造顺序(对比`深度优先`建造顺序).

* 广度优先: 比如先生成所有的房子,再生成所有房子的装饰
* 深度优先: 比如先生成一座房子,然后是里面的装饰,然后再生成下一座房子.

首先生成某一级别的所有建筑,再生成低一级别的所有建筑,直到没有下一级别的建筑为止.

建造会有一个矩形范围作为整个建造的边界,所有建筑模型生成都不会越过这个边界.
生成时,可以指定建造的深度,即层数不会超过这个深度.
