---
layout: post
title:  菜单编辑文档
categories: 教程
author: kongkongye
---

* content
{:toc}

如果你是一个`服主`,你的服务器装有此菜单MOD对应的插件,你可以查阅以编写服务器专用的菜单.

如果你是一个MOD或插件的`开发者`,希望使用此菜单MOD作为你的MOD/插件的功能界面,你可以查阅此文档.

其它情况下,你也可以查阅此文档,以编写自定义的菜单并发布或自己使用.




## 菜单配置介绍
菜单的整体结构为`仓库 > 命名空间 > 菜单路径`,每个菜单仓库内有若干命名空间,每个命名空间内有若干菜单.

#### 菜单仓库
一共有3个菜单仓库:

1. `本地菜单仓库(local)`: 本地菜单仓库默认注册有菜单MOD内置菜单的命名空间`default`,
                        其它客户端MOD也可以注册额外的命名空间
2. `服务器菜单仓库(server)`: 服务器菜单仓库只有在连接上服务器,且服务器装有对应的菜单插件时,才会生效.
                          并且进入不同的服务器,菜单仓库也是不同的.
3. `第三方菜单仓库(third)`: 如果需要自定义菜单,可以在此仓库下建立命名空间与菜单.
                          也可以从网上下载其它人发布的菜单,下载的菜单属于命名空间,将会放入第三方菜单仓库.

#### 命名空间
不管哪个菜单仓库,其内的命名空间名都没有格式要求.

对于本地菜单仓库,不同MOD注册的菜单放在不同的命名空间下.
对于服务器菜单仓库,不同插件注册的菜单放在不同的命名空间下.
对于第三方菜单仓库,下载的与自建的菜单都放在不同的命名空间下.

#### 菜单路径
一个命名空间内可以放置若干个菜单,每个菜单都有一个路径,菜单路径是相对于命名空间目录的.

菜单路径也可以有多级结构,
比如命名空间内有`main.xml`文件,那菜单路径就是`main`,
比如命名空间内有`dir`目录,目录内有`main.xml`文件,那菜单路径就是`dir/main`,
即多级路径以`/`分隔,其它的以此类推.

#### 菜单目录结构
进入菜单MOD配置目录,可以看到以下的目录结构:

* `menus`: 菜单配置根目录
  * `local`: 本地类型菜单仓库
    * `default`: 内置默认命名空间
  * `server`
    * `uid1`: 服务器类型菜单仓库(这里的uid即服务器uid)
      * `namespace1`: 命名空间
      * `namespace2`
    * `uid2`
  * `third`: 第三方类型菜单仓库
    * `namespace1`: 下载或自建的命名空间

        下载的会自动设置UUID格式的命名空间名,但这并非必须的,
        事实上这里的命名空间名称没有格式要求.

    * `namespace2`

#### 菜单文件格式
菜单文件采用`xml`格式,此文件格式下,有些字符需要转义,如`&<>`.

因为颜色字符使用比较频繁,因此菜单配置中颜色字符使用`$`代替(而非`&`).

## 菜单编辑器
#### xml文本编辑器
适合`开发者`使用

1. 推荐使用[IntelliJ IDEA](https://www.jetbrains.com/idea/),包含自动提示
2. 如果使用其它xml编辑器,推荐选用会根据`xsd`来进行`智能提示补全`的编辑器
3. 不要使用纯文本编辑器,否则会很痛苦!

`xsd`是什么?

xsd是用来描述xml文档元素的,比如line元素里可以有哪些属性,都会在里面说明,以及一些限制关系.
因此xsd主要有两种作用,一是编辑好xml后根据xsd来验证正确性,二是在编辑xml时可以进行智能提示,
但可能只有少数的编辑器支持根据xsd进行智能提示的功能.

菜单插件的`xsd`文件在哪?
[http://xsd.kongkongye.com/MenuMod.xsd](http://xsd.kongkongye.com/MenuMod.xsd)

#### 菜单配置网页编辑器
适合`服主`使用

此方式操作简单,界面比较直观,适合不熟悉xml,不熟悉xsd的用户使用.

## 入口菜单
入口菜单是什么?
想象一下,你在第三方仓库内新建了一个命名空间,在里面新建了一些菜单,
那么在游戏内应该怎样进入这些菜单呢?这就是入口菜单的作用了.

如果你将菜单文件名以`index`开头,那么此菜单就会被当作入口菜单收集起来.
而主菜单默认会展示入口菜单列表,因此玩家就能通过主菜单找到并进入你设置的菜单了.
